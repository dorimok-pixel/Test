# meta developer: @mofkomodules
# name: StickerMaker

import io
import gzip
from telethon.tl.types import DocumentAttributeFilename
from .. import loader, utils

# Исходный JSON-код анимации
lottie_json_str = """
{"nm":"Main Scene","ddd":0,"h":512,"w":512,"meta":{"g":"@lottiefiles/creator 1.53.2"},"layers":[{"ty":0,"nm":"Precomp Layer Main Scene","sr":1,"st":0,"op":52.5,"ip":0,"hd":false,"ddd":0,"bm":0,"hasMask":false,"ao":0,"ks":{"a":{"a":0,"k":[256,256]},"s":{"a":0,"k":[100,100]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[256,256]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}},"w":512,"h":512,"refId":"precomp_Main Scene_8aW_saLV2M_06dc9a1b-8e96-46ea-8c0f-a74295e7dedb","ind":1}],"v":"5.7.0","fr":30,"op":53,"ip":0,"assets":[{"nm":"Scene","id":"comp_0_8ec13156-fc79-46c8-bff7-6141925248a2_5934d7ad-57c9-4062-8191-c694b98d7d3d_ae23cbda-aee0-4af9-b63e-88d7831ebb2b_4d402f67-e6da-4726-a7c1-377c9a53a88f","layers":[{"ty":0,"nm":"@TypeFrag","sr":1,"st":0,"op":52.5,"ip":0,"hd":false,"ddd":0,"bm":0,"hasMask":false,"ao":0,"ks":{"a":{"a":0,"k":[288.9999891743314,65.00000154652409]},"s":{"a":0,"k":[64.35109836931262,65.92970810880419]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[304.98880341127284,212.58843526288564]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}},"w":578,"h":130,"refId":"precomp_Shape Layer - SVG_OC3usf1r--_55276374-4bc9-46c7-b573-3eb00b5f28f4","ind":1},{"ty":0,"nm":"Type","sr":1,"st":0,"op":52.5,"ip":0,"hd":false,"ddd":0,"bm":0,"hasMask":false,"ao":0,"ks":{"a":{"a":0,"k":[248.4999891743314,65.00000154652409]},"s":{"a":0,"k":[100,100]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[317.50590650233335,117.2659442425646]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}},"w":497,"h":130,"refId":"precomp_Shape Layer - SVG__SmS18l1hs_563467ee-187b-46e2-9174-2a4c672c883e","ind":2}]},{"nm":"@ShinyGps_1","id":"precomp_newScene_b8da26bb-e147-47ce-accd-0b11868554be_e0768b1b-9a2c-4395-a247-2409b1201781_acc69890-aa95-441a-a9f8-73e50d77bb38","layers":[{"ty":4,"nm":"@ShinyGps","sr":1,"st":0,"op":52.5,"ip":0,"hd":false,"ddd":0,"bm":0,"hasMask":false,"ao":0,"ks":{"a":{"a":0,"k":[40.22500030696392,11.852050065994263]},"s":{"a":0,"k":[100,100]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[40.22500030696392,11.852050065994263]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}},"shapes":[{"ty":"gr","bm":0,"hd":false,"nm":"s","it":[{"ty":"sh","bm":0,"hd":false,"nm":"s","d":1,"ks":{"a":0,"k":{"c":true,"i":[[0,0],[0.9066666666666663,0.9733333333333339],[0,0],[0,0],[-0.693333333333328,0],[0,0],[-0.2000000000000076,0.15999999999999895],[0,0.2600000000000004],[0,0],[0.1933333333333375,0.13333333333333405],[0.6200000000000045,0.14666666666666708],[0,0],[0.346666666666664,0.426666666666667],[0,0.6266666666666675],[0,0],[-0.5599999999999928,0.4800000000000004],[-0.960000000000008,0],[0,0],[-0.47333333333333866,-0.2133333333333335],[-0.419999999999997,-0.5333333333333338],[0,0],[0,0],[0.6066666666666644,0],[0,0],[0.1933333333333375,-0.11999999999999982],[0,-0.24666666666666615],[0,0],[-0.14000000000000531,-0.11999999999999982],[-0.45999999999999847,-0.11333333333333329],[0,0],[-0.4200000000000064,-0.4400000000000001],[0,-0.6733333333333332],[0,0],[0.28000000000000114,-0.413333333333334],[0.4866666666666693,-0.23999999999999963],[0.6066666666666739,0],[0,0]],"o":[[-1.3999999999999961,0],[0,0],[0,0],[0.6066666666666739,0.6866666666666662],[0,0],[0.36666666666666475,0],[0.1999999999999981,-0.16000000000000014],[0,0],[0,-0.2333333333333331],[-0.1999999999999981,-0.13333333333333286],[0,0],[-1.0133333333333308,-0.24666666666666615],[-0.346666666666664,-0.42666666666666586],[0,0],[0,-0.7466666666666661],[0.5533333333333322,-0.47333333333333333],[0,0],[0.693333333333328,0],[0.47333333333332916,0.21333333333333293],[0,0],[0,0],[-0.37333333333333485,-0.5933333333333325],[0,0],[-0.3133333333333326,0],[-0.18666666666666742,0.11999999999999982],[0,0],[0,0.17333333333333437],[0.14666666666666592,0.12666666666666634],[0,0],[1.139999999999996,0.29999999999999954],[0.419999999999997,0.43333333333333357],[0,0],[0,0.5],[-0.28666666666666174,0.4066666666666663],[-0.4933333333333299,0.23333333333333428],[0,0],[0,0]],"v":[[76.88,16.21],[73.42,14.75],[73.42,14.75],[74.88,13.42],[76.83,14.45],[76.83,14.45],[77.68,14.21],[77.98,13.58],[77.98,13.58],[77.69,13.03],[76.46,12.61],[76.46,12.61],[74.42,11.6],[73.9,10.02],[73.9,10.02],[74.74,8.18],[77.01,7.47],[77.01,7.47],[78.76,7.79],[80.1,8.91],[80.1,8.91],[78.53,10.11],[77.06,9.22],[77.06,9.22],[76.3,9.4],[76.02,9.95],[76.02,9.95],[76.23,10.39],[77.14,10.75],[77.14,10.75],[79.48,11.86],[80.11,13.52],[80.11,13.52],[79.69,14.89],[78.53,15.86],[76.88,16.21],[76.88,16.21]]}}},{"ty":"fl","bm":0,"hd":false,"nm":"Fill","c":{"a":0,"k":[0.6549,0.6549,0.6549]},"r":1,"o":{"a":0,"k":100}},{"ty":"tr","a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}}]},{"ty":"gr","bm":0,"hd":false,"nm":"p","it":[{"ty":"sh","bm":0,"hd":false,"nm":"p","d":1,"ks":{"a":0,"k":{"c":true,"i":[[0,0],[0,0],[0,0],[0,0],[-0.4133333333333364,0.2599999999999992],[-0.6933333333333375,0],[0,0],[-0.6266666666666652,-0.39999999999999974],[-0.37333333333333485,-0.6666666666666666],[0,-0.7866666666666665],[0,0],[0.36666666666666475,-0.6600000000000001],[0.6266666666666652,-0.3866666666666667],[0.7466666666666697,0],[0,0],[0.419999999999997,0.25333333333333385],[0.23333333333332953,0.46000000000000085],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0.24666666666666023,-0.48666666666666697],[0.419999999999997,-0.2666666666666669],[0,0],[0.7466666666666697,0],[0.6266666666666652,0.39333333333333326],[0.36666666666666475,0.6666666666666666],[0,0],[0,0.7933333333333342],[-0.37333333333333485,0.6599999999999989],[-0.6266666666666652,0.3933333333333344],[0,0],[-0.6733333333333368,0],[-0.426666666666667,-0.24666666666666615],[0,0],[0,0],[0,0],[0,0]],"v":[[64.35,19.2],[64.35,7.68],[66.48,7.68],[66.48,9.02],[67.47,7.9],[69.14,7.5],[69.14,7.5],[71.2,8.1],[72.7,9.69],[73.25,11.87],[73.25,11.87],[72.7,14.05],[71.2,15.62],[69.14,16.21],[69.14,16.21],[67.5,15.83],[66.51,14.77],[66.51,14.77],[66.51,19.2],[64.35,19.2]]}}},{"ty":"sh","bm":0,"hd":false,"nm":"p","d":1,"ks":{"a":0,"k":{"c":true,"i":[[0,0],[-0.19333333333332803,-0.3600000000000006],[-0.36000000000000415,-0.2133333333333335],[-0.45333333333333786,0],[0,0],[-0.3466666666666735,0.22000000000000006],[-0.1933333333333375,0.366666666666666],[0,0.426666666666667],[0,0],[0.1933333333333375,0.35999999999999943],[0.3533333333333341,0.22000000000000006],[0.4533333333333284,0],[0,0],[0.3599999999999947,-0.21333333333333235],[0.18666666666666742,-0.36666666666666714],[0,-0.4333333333333324],[0,0]],"o":[[0,0.4400000000000001],[0.18666666666666742,0.366666666666666],[0.3599999999999947,0.2133333333333335],[0,0],[0.4533333333333284,0],[0.346666666666664,-0.22000000000000006],[0.1999999999999981,-0.36666666666666714],[0,0],[0,-0.4400000000000001],[-0.19333333333332803,-0.36666666666666714],[-0.3466666666666735,-0.21333333333333235],[0,0],[-0.45333333333333786,0],[-0.36000000000000415,0.22000000000000006],[-0.19333333333332803,0.3733333333333337],[0,0],[0,0]],"v":[[66.45,11.87],[66.74,13.07],[67.56,13.94],[68.78,14.26],[68.78,14.26],[69.98,13.93],[70.79,13.05],[71.09,11.86],[71.09,11.86],[70.8,10.66],[69.98,9.78],[68.78,9.46],[68.78,9.46],[67.56,9.78],[66.74,10.66],[66.45,11.87],[66.45,11.87]]}}},{"ty":"fl","bm":0,"hd":false,"nm":"Fill","c":{"a":0,"k":[0.6549,0.6549,0.6549]},"r":1,"o":{"a":0,"k":100}},{"ty":"tr","a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}}]},{"ty":"gr","bm":0,"hd":false,"nm":"G","it":[{"ty":"sh","bm":0,"hd":false,"nm":"G","d":1,"ks":{"a":0,"k":{"c":true,"i":[[0,0],[0.8933333333333309,0.5200000000000008],[0.5133333333333306,0.8866666666666667],[0,1.0533333333333335],[0,0],[-0.5133333333333354,0.8866666666666667],[-0.8866666666666703,0.5200000000000001],[-1.0866666666666684,0],[0,0],[-0.6666666666666666,-0.2933333333333336],[-0.47999999999999926,-0.5866666666666666],[0,0],[0,0],[0.426666666666667,0.18666666666666684],[0.5133333333333306,0],[0,0],[0.5333333333333314,-0.33999999999999986],[0.28666666666666646,-0.5733333333333329],[0,-0.6866666666666662],[0,0],[-0.28666666666666646,-0.5733333333333341],[-0.5333333333333362,-0.33999999999999986],[-0.7066666666666682,0],[0,0],[-0.5400000000000015,0.426666666666667],[-0.12666666666666515,0.8666666666666671],[0,0],[0,0],[0,0],[0,0],[0,-0.4599999999999997],[0,0],[0.4333333333333371,-0.8133333333333326],[0.8200000000000026,-0.4599999999999997],[1.099999999999999,0],[0,0]],"o":[[-1.0866666666666684,0],[-0.8866666666666703,-0.5133333333333331],[-0.5133333333333354,-0.8866666666666667],[0,0],[0,-1.0599999999999998],[0.5133333333333306,-0.8933333333333332],[0.8933333333333309,-0.5266666666666667],[0,0],[0.9266666666666671,0],[0.6666666666666666,0.293333333333333],[0,0],[0,0],[-0.30666666666666725,-0.3333333333333333],[-0.426666666666667,-0.18666666666666684],[0,0],[-0.7066666666666682,0],[-0.5333333333333362,0.3333333333333333],[-0.28666666666666646,0.5666666666666677],[0,0],[0,0.6799999999999997],[0.28666666666666646,0.5666666666666664],[0.5333333333333314,0.3333333333333333],[0,0],[0.8933333333333309,0],[0.5400000000000015,-0.42666666666666586],[0,0],[0,0],[0,0],[0,0],[0.05333333333333693,0.3733333333333337],[0,0],[0,1.0333333333333339],[-0.4266666666666623,0.8066666666666672],[-0.8133333333333326,0.46000000000000085],[0,0],[0,0]],"v":[[57.92,16.21],[54.95,15.43],[52.85,13.33],[52.08,10.42],[52.08,10.42],[52.85,7.5],[54.95,5.38],[57.92,4.59],[57.92,4.59],[60.31,5.03],[62.03,6.35],[62.03,6.35],[60.43,7.73],[59.33,6.95],[57.92,6.67],[57.92,6.67],[56.06,7.18],[54.83,8.54],[54.4,10.42],[54.4,10.42],[54.83,12.3],[56.06,13.66],[57.92,14.16],[57.92,14.16],[60.07,13.52],[61.07,11.58],[61.07,11.58],[57.39,11.62],[57.39,9.6],[63.23,9.6],[63.31,10.85],[63.31,10.85],[62.66,13.62],[60.79,15.52],[57.92,16.21],[57.92,16.21]]}}},{"ty":"fl","bm":0,"hd":false,"nm":"Fill","c":{"a":0,"k":[0.6549,0.6549,0.6549]},"r":1,"o":{"a":0,"k":100}},{"ty":"tr","a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}}]},{"ty":"gr","bm":0,"hd":false,"nm":"y","it":[{"ty":"sh","bm":0,"hd":false,"nm":"y","d":1,"ks":{"a":0,"k":{"c":true,"i":[[0,0],[0.36666666666666475,0.10666666666666676],[0,0],[0,0],[-0.3533333333333341,0],[0,0],[-0.27333333333333104,0.22666666666666657],[-0.12666666666666515,0.379999999999999],[0,0],[0,0],[0,0],[0,0],[0,0],[-0.08666666666666838,-0.4800000000000004],[0,0],[-0.14666666666666592,0.4066666666666663],[0,0],[0,0],[0,0],[0,0],[0.5799999999999983,-0.48666666666666697],[0.9200000000000017,0],[0,0]],"o":[[-0.5933333333333337,0],[0,0],[0,0],[0.29999999999999716,0.07333333333333296],[0,0],[0.3933333333333356,0],[0.2733333333333358,-0.23333333333333428],[0,0],[0,0],[0,0],[0,0],[0,0],[0.14666666666666592,0.4066666666666663],[0,0],[0.08666666666666838,-0.4800000000000004],[0,0],[0,0],[0,0],[0,0],[-0.38666666666667027,0.9066666666666663],[-0.5799999999999983,0.47999999999999926],[0,0],[0,0]],"v":[[44.54,19.34],[43.1,19.18],[43.1,19.18],[43.42,17.12],[44.4,17.23],[44.4,17.23],[45.4,16.89],[46,15.97],[46,15.97],[46.11,15.62],[42.82,7.68],[45.42,7.68],[47.04,12.43],[47.39,13.76],[47.39,13.76],[47.74,12.43],[47.74,12.43],[49.36,7.68],[51.92,7.68],[48.24,16.53],[46.79,18.62],[44.54,19.34],[44.54,19.34]]}}},{"ty":"fl","bm":0,"hd":false,"nm":"Fill","c":{"a":0,"k":[0.6549,0.6549,0.6549]},"r":1,"o":{"a":0,"k":100}},{"ty":"tr","a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}}]},{"ty":"gr","bm":0,"hd":false,"nm":"n","it":[{"ty":"sh","bm":0,"hd":false,"nm":"n","d":1,"ks":{"a":0,"k":{"c":true,"i":[[0,0],[0,0],[0,0],[0,0],[-1.2599999999999956,0],[0,0],[-0.480000000000004,-0.27999999999999997],[-0.2799999999999964,-0.5133333333333331],[0,-0.6799999999999997],[0,0],[0,0],[0,0],[0,0],[0.32000000000000267,0.33999999999999986],[0.5600000000000023,0],[0,0],[0.3333333333333333,-0.3466666666666664],[0,-0.6799999999999997],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0.44000000000000244,-0.9400000000000001],[0,0],[0.5933333333333337,0],[0.47999999999999926,0.28666666666666646],[0.28000000000000114,0.5200000000000008],[0,0],[0,0],[0,0],[0,0],[0,-0.6933333333333328],[-0.3199999999999979,-0.33999999999999986],[0,0],[-0.4866666666666646,0],[-0.326666666666668,0.3466666666666664],[0,0],[0,0],[0,0],[0,0]],"v":[[35.06,16],[35.06,7.68],[37.18,7.68],[37.18,8.9],[39.73,7.49],[39.73,7.49],[41.34,7.91],[42.48,9.11],[42.9,10.91],[42.9,10.91],[42.9,16],[40.74,16],[40.74,11.44],[40.26,9.89],[38.94,9.38],[38.94,9.38],[37.71,9.9],[37.22,11.44],[37.22,11.44],[37.22,16],[35.06,16]]}}},{"ty":"fl","bm":0,"hd":false,"nm":"Fill","c":{"a":0,"k":[0.6549,0.6549,0.6549]},"r":1,"o":{"a":0,"k":100}},{"ty":"tr","a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}}]},{"ty":"gr","bm":0,"hd":false,"nm":"i","it":[{"ty":"sh","bm":0,"hd":false,"nm":"i","d":1,"ks":{"a":0,"k":{"c":true,"i":[[0,0],[0,0],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0,0],[0,0]],"v":[[31.62,16],[31.62,7.68],[33.78,7.68],[33.78,16],[31.62,16]]}}},{"ty":"sh","bm":0,"hd":false,"nm":"i","d":1,"ks":{"a":0,"k":{"c":true,"i":[[0,0],[-0.2533333333333327,0.23999999999999963],[-0.36666666666666475,0],[0,0],[-0.24666666666666495,-0.24666666666666673],[0,-0.3533333333333335],[0,0],[0.23999999999999963,-0.2400000000000002],[0.37333333333333485,0],[0,0],[0.24666666666666734,0.24666666666666673],[0,0.3533333333333335],[0,0]],"o":[[0,-0.3533333333333335],[0.24666666666666734,-0.24666666666666673],[0,0],[0.37333333333333485,0],[0.23999999999999963,0.23999999999999963],[0,0],[0,0.36666666666666653],[-0.24666666666666495,0.24666666666666673],[0,0],[-0.36666666666666475,0],[-0.2533333333333327,-0.25333333333333324],[0,0],[0,0]],"v":[[31.39,5.71],[31.77,4.82],[32.69,4.45],[32.69,4.45],[33.62,4.82],[33.98,5.71],[33.98,5.71],[33.62,6.62],[32.69,6.99],[32.69,6.99],[31.77,6.62],[31.39,5.71],[31.39,5.71]]}}},{"ty":"fl","bm":0,"hd":false,"nm":"Fill","c":{"a":0,"k":[0.6549,0.6549,0.6549]},"r":1,"o":{"a":0,"k":100}},{"ty":"tr","a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}}]},{"ty":"gr","bm":0,"hd":false,"nm":"h","it":[{"ty":"sh","bm":0,"hd":false,"nm":"h","d":1,"ks":{"a":0,"k":{"c":true,"i":[[0,0],[0,0],[0,0],[0,0],[-1.2266666666666666,0],[0,0],[-0.47999999999999926,-0.27999999999999997],[-0.28000000000000114,-0.5133333333333331],[0,-0.6799999999999997],[0,0],[0,0],[0,0],[0,0],[0.3200000000000003,0.33999999999999986],[0.5599999999999999,0],[0,0],[0.3333333333333333,-0.3466666666666664],[0,-0.6799999999999997],[0,0],[0,0],[0,0]],"o":[[0,0],[0,0],[0,0],[0.4466666666666678,-0.8933333333333332],[0,0],[0.5933333333333337,0],[0.47999999999999926,0.28666666666666646],[0.28000000000000114,0.5200000000000008],[0,0],[0,0],[0,0],[0,0],[0,-0.6933333333333328],[-0.3200000000000003,-0.33999999999999986],[0,0],[-0.48666666666666697,0],[-0.326666666666668,0.3466666666666664],[0,0],[0,0],[0,0],[0,0]],"v":[[22.58,16],[22.58,4.32],[24.74,4.32],[24.74,8.83],[27.25,7.49],[27.25,7.49],[28.86,7.91],[30,9.11],[30.42,10.91],[30.42,10.91],[30.42,16],[28.26,16],[28.26,11.44],[27.78,9.89],[26.46,9.38],[26.46,9.38],[25.23,9.9],[24.74,11.44],[24.74,11.44],[24.74,16],[22.58,16]]}}},{"ty":"fl","bm":0,"hd":false,"nm":"Fill","c":{"a":0,"k":[0.6549,0.6549,0.6549]},"r":1,"o":{"a":0,"k":100}},{"ty":"tr","a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}}]},{"ty":"gr","bm":0,"hd":false,"nm":"S","it":[{"ty":"sh","bm":0,"hd":false,"nm":"S","d":1,"ks":{"a":0,"k":{"c":true,"i":[[0,0],[0.7333333333333343,0.3933333333333344],[0.4666666666666674,0.8333333333333334],[0,0],[0,0],[-0.4333333333333324,-0.27333333333333343],[-0.5133333333333331,0],[0,0],[-0.30666666666666725,0.23333333333333428],[0,0.38000000000000017],[0,0],[0.22666666666666657,0.22666666666666657],[0.3466666666666664,0.13333333333333405],[0.5599999999999999,0.15333333333333363],[0,0],[0.49333333333333346,0.5199999999999996],[0,0.8199999999999997],[0,0],[-0.3333333333333333,0.5066666666666665],[-0.5933333333333325,0.2800000000000005],[-0.7799999999999988,0],[0,0],[-0.5933333333333337,-0.3533333333333329],[-0.43333333333333474,-0.6866666666666669],[0,0],[0,0],[0.29333333333333184,0.19999999999999987],[0.4066666666666687,0],[0,0],[0.29333333333333184,-0.22000000000000006],[0,-0.3733333333333331],[0,0],[-0.28666666666666646,-0.18666666666666623],[-0.6066666666666668,-0.19333333333333277],[0,0],[-0.4466666666666678,-0.20000000000000048],[-0.3866666666666679,-0.4733333333333327],[0,-0.7799999999999999],[0,0],[0.3266666666666656,-0.5133333333333331],[0.6199999999999998,-0.27999999999999997],[0.8333333333333334,0],[0,0]],"o":[[-0.9266666666666646,0],[-0.7333333333333331,-0.3866666666666667],[0,0],[0,0],[0.27333333333333343,0.5533333333333333],[0.43333333333333474,0.27333333333333343],[0,0],[0.5066666666666654,0],[0.30666666666666725,-0.23999999999999963],[0,0],[0,-0.3533333333333329],[-0.22666666666666657,-0.22000000000000006],[-0.34666666666666873,-0.13333333333333286],[0,0],[-0.8999999999999986,-0.2333333333333331],[-0.5,-0.5266666666666673],[0,0],[0,-0.6600000000000001],[0.3333333333333333,-0.5066666666666665],[0.6000000000000014,-0.2733333333333328],[0,0],[0.8400000000000011,0],[0.5933333333333314,0.34666666666666696],[0,0],[0,0],[-0.27333333333333343,-0.4466666666666666],[-0.28666666666666646,-0.19333333333333336],[0,0],[-0.45333333333333314,0],[-0.28666666666666646,0.22666666666666657],[0,0],[0,0.3733333333333337],[0.29333333333333184,0.18666666666666742],[0,0],[0.7466666666666674,0.2333333333333331],[0.44666666666666544,0.206666666666667],[0.37999999999999784,0.4733333333333339],[0,0],[0,0.6733333333333332],[-0.3333333333333333,0.5199999999999996],[-0.6133333333333345,0.2866666666666677],[0,0],[0,0]],"v":[[17.49,16.21],[15,15.62],[13.2,13.79],[13.2,13.79],[15.14,12.56],[16.2,13.8],[17.62,14.21],[17.62,14.21],[18.84,13.86],[19.3,12.93],[19.3,12.93],[18.96,12.06],[18.1,11.53],[16.74,11.1],[16.74,11.1],[14.65,9.97],[13.9,7.95],[13.9,7.95],[14.4,6.2],[15.79,5.02],[17.86,4.61],[17.86,4.61],[20.01,5.14],[21.55,6.69],[21.55,6.69],[19.63,7.87],[18.78,6.9],[17.74,6.61],[17.74,6.61],[16.62,6.94],[16.19,7.84],[16.19,7.84],[16.62,8.68],[17.97,9.25],[17.97,9.25],[19.76,9.9],[21.01,10.92],[21.58,12.8],[21.58,12.8],[21.09,14.58],[19.66,15.78],[17.49,16.21],[17.49,16.21]]}}},{"ty":"fl","bm":0,"hd":false,"nm":"Fill","c":{"a":0,"k":[0.6549,0.6549,0.6549]},"r":1,"o":{"a":0,"k":100}},{"ty":"tr","a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}}]},{"ty":"gr","bm":0,"hd":false,"nm":"@","it":[{"ty":"sh","bm":0,"hd":false,"nm":"@","d":1,"ks":{"a":0,"k":{"c":true,"i":[[0,0],[0.973333333333333,0.5599999999999999],[0.56,0.9600000000000009],[0,1.1733333333333331],[0,0],[-0.5599999999999999,0.9666666666666662],[-0.9733333333333333,0.5599999999999999],[-1.1866666666666663,0],[0,0],[-0.9266666666666659,-0.5333333333333332],[-0.5199999999999996,-0.8733333333333336],[0,-0.9733333333333327],[0,0],[0.27333333333333343,-0.5400000000000004],[0.4733333333333327,-0.28666666666666646],[0.5799999999999995,0],[0,0],[0.38000000000000017,0.18666666666666623],[0.10666666666666676,0.37333333333333246],[0,0],[0.28666666666666646,-0.22666666666666657],[0.4400000000000001,0],[0,0],[0.4800000000000004,0.49333333333333346],[0,0.7666666666666669],[0,0],[-0.2666666666666666,0.48666666666666697],[-0.4599999999999997,0.29999999999999954],[-0.5399999999999997,0],[0,0],[-0.3200000000000003,-0.5333333333333338],[0,0],[0,0],[0,0],[0,0],[0,-0.17999999999999972],[0,0],[-0.07999999999999947,-0.10000000000000024],[-0.15333333333333243,0],[0,0],[-0.1800000000000009,0.13333333333333405],[-0.11999999999999982,0.30666666666666603],[0,0.48666666666666697],[0,0],[0.3533333333333329,0.6133333333333333],[0.6533333333333324,0.3866666666666661],[0.86,0],[0,0],[0.6999999999999998,-0.42000000000000054],[0.38666666666666644,-0.7133333333333335],[0,-0.8399999999999999],[0,0],[-0.39333333333333353,-0.7133333333333335],[-0.7066666666666667,-0.41333333333333283],[-0.8866666666666667,0],[0,0],[-0.5000000000000006,0.16000000000000134],[0,0],[0,0],[0.7466666666666667,0],[0,0]],"o":[[-1.1933333333333334,0],[-0.9666666666666668,-0.5599999999999999],[-0.5599999999999999,-0.9599999999999996],[0,0],[0,-1.1600000000000001],[0.56,-0.9666666666666673],[0.9733333333333336,-0.5599999999999999],[0,0],[1.1600000000000008,0],[0.9200000000000005,0.5266666666666667],[0.5133333333333331,0.8733333333333336],[0,0],[0,0.7333333333333331],[-0.27999999999999997,0.5400000000000004],[-0.4733333333333339,0.28666666666666646],[0,0],[-0.4466666666666666,0],[-0.3733333333333331,-0.18666666666666742],[0,0],[-0.15333333333333363,0.3333333333333333],[-0.28666666666666646,0.2333333333333331],[0,0],[-0.7533333333333333,0],[-0.4799999999999998,-0.49333333333333346],[0,0],[0,-0.5399999999999991],[0.2733333333333337,-0.48666666666666697],[0.46000000000000024,-0.3000000000000007],[0,0],[0.7200000000000001,0],[0,0],[0,0],[0,0],[0,0],[-0.046666666666666856,0.27999999999999997],[0,0],[0,0.16666666666666666],[0.08000000000000067,0.09333333333333371],[0,0],[0.16666666666666666,0],[0.1733333333333332,-0.13333333333333286],[0.12666666666666634,-0.31333333333333374],[0,0],[0,-0.6066666666666668],[-0.3533333333333341,-0.6066666666666668],[-0.6600000000000001,-0.3933333333333338],[0,0],[-0.8733333333333336,0],[-0.7000000000000002,0.41333333333333283],[-0.39333333333333353,0.706666666666667],[0,0],[0,0.8533333333333329],[0.38666666666666644,0.706666666666667],[0.6999999999999998,0.40666666666666745],[0,0],[0.5,0],[0,0],[0,0],[-0.6533333333333337,0.22000000000000122],[0,0],[0,0]],"v":[[6.72,17.98],[3.47,17.14],[1.18,14.86],[0.34,11.66],[0.34,11.66],[1.18,8.47],[3.48,6.18],[6.72,5.34],[6.72,5.34],[9.85,6.14],[12.01,8.24],[12.78,11.01],[12.78,11.01],[12.37,12.92],[11.24,14.16],[9.66,14.59],[9.66,14.59],[8.42,14.31],[7.7,13.47],[7.7,13.47],[7.04,14.31],[5.95,14.66],[5.95,14.66],[4.1,13.92],[3.38,12.03],[3.38,12.03],[3.78,10.49],[4.88,9.31],[6.38,8.86],[6.38,8.86],[7.94,9.66],[7.94,9.66],[8.02,8.99],[9.81,8.99],[9.46,11.76],[9.39,12.45],[9.39,12.45],[9.51,12.85],[9.86,12.99],[9.86,12.99],[10.38,12.79],[10.82,12.13],[11.01,10.93],[11.01,10.93],[10.48,9.1],[8.97,7.61],[6.69,7.02],[6.69,7.02],[4.33,7.65],[2.7,9.34],[2.11,11.66],[2.11,11.66],[2.7,14.01],[4.34,15.69],[6.72,16.3],[6.72,16.3],[8.22,16.06],[8.22,16.06],[8.82,17.65],[6.72,17.98],[6.72,17.98]]}}},{"ty":"sh","bm":0,"hd":false,"nm":"@","d":1,"ks":{"a":0,"k":{"c":true,"i":[[0,0],[-0.19333333333333336,-0.206666666666667],[-0.33999999999999986,0],[0,0],[-0.2600000000000004,0.27999999999999997],[0,0.3866666666666667],[0,0],[0.19333333333333336,0.2066666666666658],[0.3533333333333329,0],[0,0],[0.2600000000000004,-0.28666666666666646],[0,-0.3866666666666667],[0,0]],"o":[[0,0.30666666666666725],[0.19999999999999987,0.2066666666666658],[0,0],[0.3866666666666667,0],[0.2599999999999998,-0.27999999999999997],[0,0],[0,-0.3200000000000003],[-0.18666666666666684,-0.206666666666667],[0,0],[-0.3866666666666667,0],[-0.2599999999999998,0.28666666666666646],[0,0],[0,0]],"v":[[5.33,11.94],[5.62,12.71],[6.43,13.02],[6.43,13.02],[7.4,12.6],[7.79,11.6],[7.79,11.6],[7.5,10.81],[6.69,10.5],[6.69,10.5],[5.72,10.93],[5.33,11.94],[5.33,11.94]]}}},{"ty":"fl","bm":0,"hd":false,"nm":"Fill","c":{"a":0,"k":[0.6549,0.6549,0.6549]},"r":1,"o":{"a":0,"k":100}},{"ty":"tr","a":{"a":0,"k":[0,0]},"s":{"a":0,"k":[100,100]},"sk":{"a":0,"k":0},"p":{"a":0,"k":[0,0]},"r":{"a":0,"k":0},"sa":{"a":0,"k":0},"o":{"a":0,"k":100}}]}],"ind":1}]}
"""

@loader.tds
class StickerMakerMod(loader.Module):
    """Создает кастомный tgs стикер с вашим текстом."""
    strings = {"name": "StickerMaker"}

    @loader.command(ru_doc="Создать и отправить кастомный стикер")
    async def makesticker(self, message):
        """Создать и отправить стикер."""
        
        # В кавычках слева - старый текст, который нужно заменить.
        # В кавычках справа - новый текст, на который нужно заменить.
        replacements = {
            "@TypeFrag": "ТВОЙ НИК",
            "Type": "ТВОЙ ТЕКСТ",
            "@ShinyGps": "ЕЩЕ ТЕКСТ",
            "HARNEL": "ЛЮБОЙ",
            "haunted": "ТЕКСТ",
            "@attackfucked": "ЗДЕСЬ"
        }
        # ------------------------------------

        await utils.answer(message, "⚙️ Создаю твой стикер...")
        
        # Заменяем текст
        modified_json_str = lottie_json_str
        for old_text, new_text in replacements.items():
            modified_json_str = modified_json_str.replace(f'"nm":"{old_text}"', f'"nm":"{new_text}"')

        # Кодируем в байты
        json_bytes = modified_json_str.encode('utf-8')
        
        # Сжимаем в gzip, как того требует Telegram для TGS
        gzipped_data = gzip.compress(json_bytes)
        
        # Создаем файл в памяти
        sticker_file = io.BytesIO(gzipped_data)
        sticker_file.name = 'sticker.tgs'

        # Удаляем сообщение "Создаю..." и отправляем стикер
        await message.delete()
        await self.client.send_file(
            message.to_id,
            sticker_file,
            attributes=[DocumentAttributeFilename(file_name='sticker.tgs')]
  )
